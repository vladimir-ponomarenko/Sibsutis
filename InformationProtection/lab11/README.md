# Лабораторная работа №11: Электронная подпись FIPS 186 (DSA)

## Описание
Реализация алгоритма электронной подписи DSA (Digital Signature Algorithm) согласно стандарту FIPS 186 для подписания и проверки файлов. DSA - это американский стандарт цифровой подписи, основанный на проблеме дискретного логарифма.

## Теоретические основы

### Алгоритм подписи DSA (FIPS 186)
DSA - это цифровая подпись, основанная на проблеме дискретного логарифма в подгруппе простого порядка, разработанная NIST.

### Генерация ключей
1. Выбирается простое число q
2. Выбирается простое число p = k*q + 1 для некоторого k
3. Выбирается элемент g порядка q по модулю p
4. Выбирается случайное число x ∈ [1, q-1] (закрытый ключ)
5. Вычисляется y = g^x mod p (открытый ключ)

### Процесс подписания
Для хеша H сообщения:
1. Выбирается случайное число k ∈ [1, q-1]
2. Вычисляется r = (g^k mod p) mod q
3. Вычисляется s = (k^(-1) * (H + x*r)) mod q
4. Подпись: (r, s)

### Процесс проверки
Для подписи (r, s) и хеша H:
1. Проверяется: 1 ≤ r < q и 1 ≤ s < q
2. Вычисляется w = s^(-1) mod q
3. Вычисляется u1 = (H * w) mod q
4. Вычисляется u2 = (r * w) mod q
5. Вычисляется v = (g^u1 * y^u2 mod p) mod q
6. Проверяется: v = r

## Использование

### Генерация ключей
```bash
python main.py generate --bits 64 --pub public.key --priv private.key
```

### Подписание файла
```bash
python main.py sign file.txt --key private.key --out file.sig
```

### Проверка подписи
```bash
python main.py verify file.txt --key public.key --sig file.sig
```

### Параметры командной строки
- `generate` - генерация пары ключей
- `sign` - подписание файла
- `verify` - проверка подписи
- `--bits` - размер простого числа в битах (по умолчанию 32)
- `--pub` - файл для открытого ключа
- `--priv` - файл для закрытого ключа
- `--key` - файл с ключом для подписания/проверки
- `--out` - файл для сохранения подписи
- `--sig` - файл с подписью для проверки

## Особенности реализации
- Использование SHA-256 для хеширования файлов
- Генерация параметров p и q с требуемыми свойствами
- Поиск элемента порядка q по модулю p
- Проверка корректности параметров подписи
- Сохранение/загрузка ключей и подписей в файлы

## Безопасность
- Основан на сложности вычисления дискретного логарифма в подгруппе
- Требует больших простых чисел для обеспечения безопасности
- Использует случайное число k для каждой подписи
- Устойчив к атакам на основе известных подписей

## Преимущества
- Американский стандарт, одобренный NIST
- Быстрая генерация ключей
- Эффективная проверка подписи
- Возможность предварительного вычисления r
- Широкое применение в американских системах

## Ограничения
- Требует генерации случайного k для каждой подписи
- Размер подписи зависит от размера q
- Необходимость хранения закрытого ключа в секрете
- Производительность зависит от размера параметров

## Математические основы
- Проблема дискретного логарифма в подгруппе: найти x такое, что g^x ≡ y (mod p)
- Теорема Эйлера: a^φ(n) ≡ 1 (mod n) для НОД(a, n) = 1
- Расширенный алгоритм Евклида для нахождения обратного элемента
- Китайская теорема об остатках для ускорения вычислений

## Отличия от других схем
- Использует подгруппу простого порядка q
- Более сложная процедура проверки подписи
- Требует специальных параметров p и q
- Оптимизирован для американских криптографических стандартов

## Стандарты FIPS 186
- FIPS 186-1: Первая версия DSA
- FIPS 186-2: Расширенная версия с поддержкой различных размеров ключей
- FIPS 186-3: Современная версия с улучшенной безопасностью
- FIPS 186-4: Текущая версия с поддержкой SHA-3
