# Лабораторная работа №5: Шифр Эль-Гамаля

## Описание
Реализация криптографического алгоритма Эль-Гамаля для шифрования и расшифровки файлов. Алгоритм основан на проблеме дискретного логарифма и обеспечивает асимметричное шифрование.

## Теоретические основы

### Алгоритм Эль-Гамаля
Шифр Эль-Гамаля - это асимметричный криптографический алгоритм, основанный на проблеме дискретного логарифма в конечных полях.

### Генерация ключей
1. Выбирается большое простое число p
2. Выбирается первообразный корень g по модулю p
3. Выбирается случайное число Db ∈ [1, p-1] (закрытый ключ)
4. Вычисляется Cb = g^Db mod p (открытый ключ)

### Процесс шифрования
Для каждого байта M сообщения:
1. Выбирается случайное число k ∈ [1, p-1]
2. Вычисляется a = g^k mod p
3. Вычисляется b = M × Cb^k mod p
4. Пара (a, b) является шифротекстом

### Процесс расшифрования
Для каждой пары (a, b):
1. Вычисляется M = b × a^(-Db) mod p
2. Используется тождество: a^(-Db) = a^(p-1-Db) mod p

## Использование

### Шифрование
```bash
python main.py input.txt encrypted.txt --action encrypt --mode generate --bits 64
```

### Расшифрование
```bash
python main.py encrypted.txt decrypted.txt --action decrypt --mode generate --bits 64
```

### Ввод параметров вручную
```bash
python main.py input.txt output.txt --action encrypt --mode input
```

### Параметры командной строки
- `input_file` - входной файл
- `output_file` - выходной файл
- `--action` - действие (encrypt/decrypt)
- `--mode` - режим работы (input/generate)
- `--bits` - размер простого числа в битах (по умолчанию 32)

## Особенности реализации
- Поддержка файлов любого размера
- Использование теста Миллера-Рабина для проверки простоты
- Автоматический поиск первообразного корня
- Обработка больших чисел (Python int неограничен)
- Каждый байт шифруется независимо

## Безопасность
- Основан на сложности вычисления дискретного логарифма
- Требует больших простых чисел для обеспечения безопасности
- Использует случайное число k для каждого байта
- Устойчив к атакам на основе известного открытого текста

## Ограничения
- Размер шифротекста в 2 раза больше размера исходного текста
- Требует хранения закрытого ключа в секрете
- Производительность зависит от размера модуля p
