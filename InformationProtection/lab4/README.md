# Лабораторная работа №4: Шифр Шамира

## Описание
Реализация криптографического протокола Шамира для шифрования и расшифровки файлов. Протокол основан на проблеме дискретного логарифма и обеспечивает безопасную передачу данных между двумя сторонами.

## Теоретические основы

### Алгоритм Шамира
Шифр Шамира - это протокол шифрования, который позволяет двум сторонам (Алисе и Бобу) безопасно обмениваться сообщениями без предварительного обмена секретными ключами.

### Математическая основа
1. Выбирается большое простое число p
2. Генерируются ключи:
   - Ca, Cb - открытые ключи Алисы и Боба
   - Da, Db - закрытые ключи Алисы и Боба
   - Условие: Ca × Da ≡ 1 (mod p-1) и Cb × Db ≡ 1 (mod p-1)

### Процесс шифрования
Для каждого байта M сообщения:
1. x1 = M^Ca mod p (Алиса шифрует)
2. x2 = x1^Cb mod p (Боб шифрует)
3. x3 = x2^Da mod p (Алиса расшифровывает)
4. M = x3^Db mod p (Боб расшифровывает)

### Симметричность
Операция полностью симметрична: encrypt(encrypt(data)) = data

## Использование

### Генерация параметров
```bash
python main.py input.txt output.txt --mode generate --bits 64
```

### Ввод параметров вручную
```bash
python main.py input.txt output.txt --mode input
```

### Параметры командной строки
- `input_file` - входной файл для шифрования
- `output_file` - выходной файл
- `--mode` - режим работы (input/generate)
- `--bits` - размер простого числа в битах (по умолчанию 32)

## Особенности реализации
- Поддержка файлов любого размера
- Использование теста Миллера-Рабина для проверки простоты
- Обработка больших чисел (Python int неограничен)
- Симметричное шифрование/расшифровка

## Безопасность
- Основан на сложности вычисления дискретного логарифма
- Требует больших простых чисел для обеспечения безопасности
- Каждый байт обрабатывается независимо
